{{ define "main" }}

{{ $nodes := slice }}
{{ $links := slice }}
{{- range (where .Site.RegularPages.ByTitle "Section" "network") -}}
  {{- $src :=  .Params.source_url -}}
  {{- $dst :=  .Params.destination_url -}}
  {{- $src_grp :=  .Params.source_type -}}
  {{- $dst_grp :=  .Params.destination_type -}}
  {{- $nodes = $nodes | append (dict "id" $src "group" $src_grp ) -}}
  {{- $nodes = $nodes | append (dict "id" $dst "group" $dst_grp ) -}}
  {{- $links = $links | append (dict "source" $src "target" $dst) -}}
{{- end -}}

{{ (dict
  "nodes" ($nodes | uniq)
  "links" ($links| uniq)) | jsonify
}}

{{- end -}}
